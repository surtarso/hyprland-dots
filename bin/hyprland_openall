#!/bin/bash
# ----------------- hyprland_openall -------------------
# Opens a predefined set of windows on their respective
# monitors/workspaces in Hyprland.
# Requires: jq, hyprctl
# Bind example: bind = $mod, backspace, exec, $HOME/bin/hyprland_openall
# --------------------------------------------------------
# Tarso Galv√£o - Mon Oct 20 2025

browser="brave --disable-features=WaylandWpColorManagerV1 --enable-features=VaapiVideoDecoder,VaapiIgnoreDriverChecks,Vulkan,DefaultANGLEVulkan,VulkanFromANGLE,UseOzonePlatform --ozone-platform=wayland --enable-gpu-rasterization --enable-zero-copy --ignore-gpu-blocklist"
webapp="$browser --force-device-scale-factor=1 --high-dpi-support=1 --app"

# === CONFIG ===
# Format: "command|workspace|monitor"
# Monitor can be name or ID as shown in `hyprctl monitors`
APPS_LIST=(
    "kitty --title clock-rs -o font_size=18 -o background_opacity=0.0 -e --class clock-rs clock-rs -c bright-blue|1|DVI-D-1"
    "kitty --title rmpc -e --class mpd-player rmpc|2|HDMI-A-3"
    "${webapp}="https://bsky.app"|2|HDMI-A-3"
    "${browser}|3|HDMI-A-1"
    "${webapp}="https://web.whatsapp.com"|4|DP-1"
    "ghostty --class=com.mitchellh.ghostty-floating|4|DP-1"
)

# Main loop (timming is critical, too fast wont work)
for APP in "${APPS_LIST[@]}"; do
    IFS="|" read -r CMD WS MON <<< "$APP"
    hyprctl dispatch focusmonitor "$MON"
    hyprctl dispatch workspace "$WS"
    sleep 0.2
    eval "$CMD" & disown
    sleep 1
done

# End focus/pointer in preferred workspace monitor (optional)
hyprctl dispatch focusmonitor HDMI-A-1
hyprctl dispatch workspace 3

notify-send "All configured apps have been launched."
echo "All configured apps have been launched."
